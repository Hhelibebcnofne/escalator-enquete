<!DOCTYPE html>
<html>
<head>
    <title>MQTT.js Publisher</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
    <p>テスト用：MQTT.js Publisher</p>

    <input type="button" value="右カウント" onclick="OnButtonClick('presence1')"/>
    <input type="button" value="左カウント" onclick="OnButtonClick('presence2')"/>

    <script>
        const clientId = 'mqtt_publisher' + Math.random().toString(16).substr(2, 8);
        const host = 'ws://broker.emqx.io:8083/mqtt';

        const options = {
            keepalive: 60,
            clientId: clientId,
            protocolId: 'MQTT',
            protocolVersion: 4,
            clean: true,
            reconnectPeriod: 1000,
            connectTimeout: 30 * 1000,
        };

        const client = mqtt.connect(host, options);

        client.on("connect", () => {
            console.log("Publisher connected to broker");
        });

        function OnButtonClick(topic) {
            const message = topic;
            console.log(`Publishing message: ${message} to topic: ${topic}`);
            client.publish(topic, message);
        }
    </script>
</body>
</html>
